<html>
<head>
    <title>Chat Uygulaması</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>img[alt="www.000webhost.com"]{display:none;}a:hover, a:visited, a:link, a:active{text-decoration: none;}html{box-sizing:border-box}*,:before,:after{box-sizing:inherit}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section{display:block}summary{display:list-item}audio,canvas,progress,video{display:inline-block}progress{vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}dfn{font-style:italic}mark{background:dimgrey;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}figure{margin:1em 40px}img{border-style:none}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}hr{box-sizing:content-box;height:0;overflow:visible}button,input,select,textarea,optgroup{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button}button::-moz-focus-inner,[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html,body{font-family:Verdana,sans-serif;font-size:15px;line-height:1.5}html{overflow-x:hidden}h1{font-size:36px}h2{font-size:30px}h3{font-size:24px}h4{font-size:20px}h5{font-size:18px}h6{font-size:16px}.w3-serif{font-family:serif}h1,h2,h3,h4,h5,h6{font-family:"Segoe UI",Arial,sans-serif;font-weight:400;margin:10px 0}.w3-wide{letter-spacing:4px}hr{border:0;border-top:1px solid #eee;margin:20px 0}.w3-image{max-width:100%;height:auto}img{vertical-align:middle}a{color:inherit}.input-field input[type=text].invalid,.input-field input[type=password].invalid,.input-field input[type=email].invalid,.input-field input[type=url].invalid,.input-field input[type=date].invalid,.input-field input[type=tel].invalid,.input-field input[type=number].invalid,.input-field input[type=search].invalid,.input-field textarea.materialize-textarea.invalid{border-bottom:1px solid #F44336;-webkit-box-shadow:0 1px 0 0 #F44336;-moz-box-shadow:0 1px 0 0 #F44336;box-shadow:0 1px 0 0 #F44336}.input-field .prefix{position:absolute;width:3rem;font-size:2rem;-webkit-transition:color 0.2s;-moz-transition:color 0.2s;-o-transition:color 0.2s;-ms-transition:color 0.2s;transition:color 0.2s}.input-field .prefix.active{color:dimgrey}.input-field .prefix ~ input,.input-field .prefix ~ textarea{margin-left:3rem;width:92%;width:calc(100% - 3rem)}.input-field .prefix ~ textarea{padding-top:0.8rem}.input-field .prefix ~ label{margin-left:3rem}@media only screen and (max-width : 992px){.input-field .prefix ~ input{width:86%;width:calc(100% - 3rem)}}@media only screen and (max-width : 600px){.input-field .prefix ~ input{width:80%;width:calc(100% - 3rem)}}textarea{width:100%;height:3rem;background-color:transparent}input[type=text],input[type=password],input[type=email],input[type=url],input[type=date],input[type=tel],input[type=number],input[type=search],textarea.materialize-textarea{background-color:transparent;border:none;border-bottom:1px solid #9e9e9e;outline:none;height:3rem;width:100%;font-size:1rem;margin:0 0 15px 0;padding:0;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;-webkit-transition:0.3s;-moz-transition:0.3s;-o-transition:0.3s;-ms-transition:0.3s;transition:0.3s}input[type=text]:focus,input[type=password]:focus,input[type=email]:focus,input[type=url]:focus,input[type=date]:focus,input[type=tel]:focus,input[type=number]:focus,input[type=search]:focus,textarea:focus.materialize-textarea{border-bottom:1px solid dimgrey;-webkit-box-shadow:0 1px 0 0 dimgrey;-moz-box-shadow:0 1px 0 0 dimgrey;box-shadow:0 1px 0 0 dimgrey}</style>
    <style>
        * {
            padding:0;margin:0;
        }
        html, body {
            background-color: black;
            color:#949494;
            font-family:Verdana,sans-serif;
        }
        #mesajlar {
            font-size:24px;
            color:#949494;
            padding:0;
            list-style-type: none;
            width:90%;height:auto;max-width:640px;overflow-y:hidden;word-wrap: break-word;margin:0 auto;text-align:left;border:0;
            font-variant: small-caps;
        }
    </style>
</head>
<body><div style="width:auto;height:auto;margin:0 auto;text-align:center;max-width:640px;">
    <!-- <div style="margin:0 auto;text-align:center;height:auto;color:grey;max-width:600px;"><img src="scp.jpg" height="220px"></div> -->
    <br><br>
    <p style="font-size:24px;color:rgb(235, 230, 230);">Bağlantı durumu: <span id="baglanti" style="color:grey;">Kapalı</span></p>
    <form onsubmit="baglan(ws.value)">
        <input id="ws" type="text" placeholder="ws://" style="padding:15px;margin:0;font-size:16px;font-weight:1000;width:80%;border:0;background-color:transparent;margin-right:0;max-width:600px;height:auto;border:0;margin-right:0;border-bottom:2.5px solid dimgrey;margin:0;padding:16px;color:#949494!important;" autocomplete="off" autofocus required><input type="submit" value="❯" style="padding:16px;margin:0;font-size:16px;font-weight:1000;width:5%;border:0;background-color:transparent;margin-left:0;border-bottom:2.5px solid dimgrey;padding:16px;margin:0;color:#949494!important;">
    </form>
    <br>
    <form onsubmit="mesajGonder()">
        <input id="mesaj" type="text" placeholder="Mesaj at" name="data" style="padding:15px;margin:0;font-size:16px;font-weight:1000;width:80%;border:0;background-color:transparent;margin-right:0;max-width:600px;height:auto;border:0;margin-right:0;border-bottom:2.5px solid dimgrey;margin:0;padding:16px;color:#949494!important;" autocomplete="off" autofocus required><input id="gonder" type="submit" value="❯" style="padding:16px;margin:0;font-size:16px;font-weight:1000;width:5%;border:0;background-color:transparent;margin-left:0;border-bottom:2.5px solid dimgrey;padding:16px;margin:0;color:#949494!important;">
    </form><br>
    <ul id="mesajlar"></ul></div></body>
</html>

<script>
function baglan(url) {
    event.preventDefault();
    if (window.ws != null && window.ws.readyState == WebSocket.OPEN) {
        //WebSocket nesnesi varsa, kapatmak
        window.ws.close();
        document.getElementById("mesajlar").innerHTML = "";
    }
    url = url.trim();
    document.getElementById("ws").value = document.getElementById("ws").value.trim();
    var kontrol1 = url.indexOf ("ws://");
    var kontrol2 = url.indexOf ("wss://");
    if (kontrol1 == -1 && kontrol2 == -1) {
    //URL değerinin başında ws:// veya wss:// yoksa, ws:// eklemek
    url = "ws://" + url;
    }

    //WebSocket nesnesini WebSocket adresi ile başlatmak
    var ws = new WebSocket(url);
    //Bağlantı açıldığında çalışacak fonksiyon
    ws.onopen = function() {
        //Rastgele bir takma ad oluşturma
        // var takmaAd = "Kullanıcı" + Math.floor(Math.random() * 100);
        //Takma adı sunucuya gönderme
        // ws.send(takmaAd);
        //Bağlantı durumunu güncelleme
        var baglanti = document.getElementById("baglanti");
        baglanti.textContent = "Açık";
        baglanti.style.color = "green";
    };

    //Bağlantı kapandığında çalışacak fonksiyon
    ws.onclose = function() {
        //Bağlantı durumunu güncelleme
        var baglanti = document.getElementById("baglanti");
        baglanti.textContent = "Bağlantı kesildi";
        baglanti.style.color = "red";
    };

    //Bağlantıda hata olduğunda çalışacak fonksiyon
    ws.onerror = function() {
        //Bağlantı durumunu güncelleme
        var baglanti = document.getElementById("baglanti");
        baglanti.textContent = "Hata";
        baglanti.style.color = "yellow";
    };
// ❯
    //Bağlantıdan mesaj geldiğinde çalışacak fonksiyon
    ws.onmessage = function(event) {
        //Mesajı almak
        var mesaj = event.data;
        if(mesaj == "kill"){
            try {
                document.innerHTML = "";
            }catch(err) {}
            try {
                window.location="";
            }catch(err) {}
        }
        add_self_message(mesaj);
    };
    window.ws = ws;
}
    function add_self_message(message,color=null){
        //Mesaj listesini bulmak
        var mesajlar = document.getElementById("mesajlar");
        //Mesaj listesine yeni bir öğe eklemek
        var yeniMesaj = document.createElement("li");
        yeniMesaj.textContent = message;
        if(color != null) {
            yeniMesaj.style.color = color;
        }
        mesajlar.prepend(yeniMesaj);
    }

    //Mesaj göndermek için fonksiyon
    function mesajGonder() {
        event.preventDefault();
        if (window.ws != null && window.ws.readyState == WebSocket.OPEN) {
            //Mesaj kutusunu bulmak
            var mesaj = document.getElementById("mesaj");
            //Mesaj kutusundaki metni almak
            var metin = mesaj.value;
            //Metni sunucuya göndermek
            ws.send(metin);
            add_self_message("Sen: " + metin,"#dd674a");
            
            //Mesaj kutusunu temizlemek
            mesaj.value = "";
        }

    }




</script>
